<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assistente Especializado RA</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü§ñ</text></svg>">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="styles.css?v=20250117l" rel="stylesheet">
    
    <!-- CSS inline para garantir que o overlay funcione -->
    <style>
        #identificacao-overlay {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            display: flex !important;
            justify-content: center !important;
            align-items: center !important;
            z-index: 99999 !important;
            opacity: 1 !important;
            visibility: visible !important;
            background: linear-gradient(135deg, rgba(0, 0, 88, 0.95) 0%, rgba(22, 52, 255, 0.9) 25%, rgba(29, 253, 185, 0.1) 50%, rgba(22, 52, 255, 0.9) 75%, rgba(0, 0, 88, 0.95) 100%) !important;
        }
        
        #identificacao-overlay.hidden {
            display: none !important;
        }
        
        .app-wrapper {
            display: none !important;
        }
        
        .app-wrapper.authenticated {
            display: block !important;
        }
        
        /* Estilos para expans√£o de linhas na tabela de solicita√ß√µes */
        .btn-expandir {
            cursor: pointer;
            padding: 5px 10px;
            border: none;
            background: transparent;
            color: #0d6efd;
            transition: transform 0.2s;
        }
        
        .btn-expandir:hover {
            color: #0a58ca;
            transform: scale(1.1);
        }
        
        .detalhes-expandidos {
            display: none;
            background-color: #f8f9fa;
        }
        
        .detalhes-expandidos.show {
            display: table-row;
            animation: slideDown 0.3s ease-out;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                max-height: 0;
            }
            to {
                opacity: 1;
                max-height: 1000px;
            }
        }
        
        .detalhes-content {
            padding: 15px;
        }
        
        .detalhes-content .campo-detalhe {
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .detalhes-content .campo-detalhe:last-child {
            border-bottom: none;
        }
        
        .detalhes-content .campo-label {
            font-weight: bold;
            color: #495057;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        .detalhes-content .campo-valor {
            color: #212529;
            white-space: pre-wrap;
            word-wrap: break-word;
            background-color: white;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #dee2e6;
        }
    </style>
    
    <!-- CSP para permitir Google APIs e recursos necess√°rios -->
    <meta http-equiv="Content-Security-Policy"
          content="default-src 'self';
                   script-src 'self' 'unsafe-inline' 'unsafe-eval' https://accounts.google.com https://www.gstatic.com https://cdn.jsdelivr.net;
                   style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://www.gstatic.com;
                   img-src 'self' data: https: http:;
                   font-src 'self' https://cdnjs.cloudflare.com;
                   frame-src https://accounts.google.com;
                   connect-src 'self' https://www.googleapis.com https://accounts.google.com https://cdn.jsdelivr.net;">
    
    <!-- Google Identity Services -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    
    <!-- Script de debug para verificar carregamento do Google -->
    <script>
        // Verificar se o Google Identity Services foi carregado
        function verificarGoogleAuth() {
            console.log('üîç Verificando Google Identity Services...');
            console.log('  - window.google:', !!window.google);
            console.log('  - window.google.accounts:', !!(window.google && window.google.accounts));
            console.log('  - window.google.accounts.id:', !!(window.google && window.google.accounts && window.google.accounts.id));
            
            if (window.google && window.google.accounts && window.google.accounts.id) {
                console.log('‚úÖ Google Identity Services carregado com sucesso!');
            } else {
                console.log('‚ùå Google Identity Services n√£o foi carregado');
                console.log('üîß Tentando recarregar...');
                setTimeout(verificarGoogleAuth, 1000);
            }
        }
        
        // Verificar ap√≥s 2 segundos
        setTimeout(verificarGoogleAuth, 2000);
    </script>
</head>
<body>
    <!-- Overlay de Login -->
    <div id="identificacao-overlay">
        <div id="identificacao-box">
            <div class="login-header">
                <img src="logo-reclame-aqui.SVG.png" alt="Velotax Bot" class="login-logo">
                <h2>Bem-vindo(a) ao Velotax Bot</h2>
                <p>Por favor, fa√ßa login com sua conta Google corporativa (@velotax.com.br).</p>
            </div>
            
            <div id="google-signin-button" class="google-signin-btn">
                <img src="https://www.google.com/favicon.ico" alt="Google Icon">
                <span>Entrar com Google</span>
            </div>
            
            <p id="identificacao-error" class="identificacao-error hidden">
                <i class="fas fa-exclamation-triangle"></i>
                Acesso permitido apenas para e-mails corporativos @velotax.com.br
            </p>
            
            <div class="login-footer">
                <small>
                    <i class="fas fa-shield-alt"></i>
                    Sistema seguro e protegido
                </small>
            </div>
        </div>
    </div>

    <!-- Conte√∫do Principal -->
    <div class="app-wrapper">
    <div class="container-fluid">
        <!-- Header Responsivo -->
        <header class="text-white mb-4" style="background: url('https://raichu-uploads.s3.amazonaws.com/companypageconfiguration_ee2e3a70-c907-4bbd-89c6-e4c4aa9f4390.jpg') center/cover no-repeat; position: relative; min-height: 180px; background-attachment: local; background-position: center top; padding-top: 0px; padding-bottom: 20px;">
            <div class="container header-container" style="padding-top: 5px;">
                <div class="row align-items-start">
                    <div class="col-md-8">
                        <p class="mb-0 opacity-95 header-subtitle" style="margin-top: -5px; margin-left: -10px; padding-top: 0px;">Assistente Especializado Reclame Aqui</p>
                    </div>
                    <div class="col-md-4 text-end">
                        <div class="header-right-content">
                            <div class="status-indicator">
                                <span class="status-dot online"></span>
                                <span class="status-text">Online</span>
                            </div>
                            <div id="user-info" class="user-info">
                                <!-- Informa√ß√µes do usu√°rio ser√£o inseridas aqui -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="container">
            <div class="row">
                <!-- Sidebar -->
                <div class="col-md-3">
                    <div class="card sidebar-card">
                        <div class="card-header bg-light">
                            <h5 class="mb-0">
                                <i class="fas fa-tools me-2"></i>
                                Ferramentas
                            </h5>
                        </div>
                        <div class="card-body p-0">
                            <nav class="nav flex-column">
                                <a class="nav-link active" href="#" data-tool="reclame-aqui">
                                    <i class="fas fa-comment-dots me-2"></i>
                                    Respostas RA
                                </a>
                                <a class="nav-link" href="#" data-tool="moderacao">
                                    <i class="fas fa-shield-alt me-2"></i>
                                    Modera√ß√£o RA
                                </a>
                                <a class="nav-link" href="#" data-tool="explicacoes">
                                    <i class="fas fa-question-circle me-2"></i>
                                    Explica√ß√µes
                                </a>
                                <a class="nav-link" href="#" data-tool="revisao">
                                    <i class="fas fa-percentage me-2"></i>
                                    Chance de Modera√ß√£o
                                </a>
                                <a class="nav-link" href="#" data-tool="emails">
                                    <i class="fas fa-envelope me-2"></i>
                                    Formula√ß√£o de E-mail
                                </a>
                                <a class="nav-link" href="#" data-tool="faq">
                                    <i class="fas fa-question me-2"></i>
                                    FAQ
                                </a>
                            </nav>
                        </div>
                    </div>

                    <!-- Quick Stats -->
                    <div class="card mt-3">
                        <div class="card-header bg-light d-flex justify-content-between align-items-center">
                            <h6 class="mb-0">
                                <i class="fas fa-chart-bar me-2"></i>
                                Estat√≠sticas
                            </h6>
                            <div class="btn-group" role="group">
                                <button class="btn btn-sm btn-outline-info" onclick="abrirModalSolicitacoes()" title="Ver Todas as Solicita√ß√µes">
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="stat-item">
                                <span class="stat-label">Respostas Hoje</span>
                                <span class="stat-value">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Modera√ß√µes</span>
                                <span class="stat-value">0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Main Content Area -->
                <div class="col-md-9">
                    <!-- Tool Content -->
                    <div id="tool-content">
                        <!-- Reclame Aqui Tool -->
                        <div id="reclame-aqui-tool" class="tool-panel active">
                            <div class="card">
                                <div class="card-header bg-success text-white">
                                    <h5 class="mb-0">
                                        <i class="fas fa-comment-dots me-2"></i>
                                        Redator de Respostas - Reclame Aqui (IA OpenAI)
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="tipo-situacao" class="form-label">Tipo de Situa√ß√£o: <span class="text-danger">*</span></label>
                                                <select class="form-select" id="tipo-situacao" required>
                                                    <option value="">Selecione o tipo...</option>
                                                    <option value="retirar-chave-pix-cpf">Retirar chave pix CPF</option>
                                                    <option value="juros-abusivos">Juros Abusivos</option>
                                                    <option value="erro-aplicativo">Erro/Aplicativo</option>
                                                    <option value="exclusao-cadastro">Exclus√£o de Cadastro</option>
                                                    <option value="credito-pessoal-indisponivel">Cr√©dito pessoal indispon√≠vel</option>
                                                    <option value="calculadora">Calculadora</option>
                                                    <option value="duvidas-credito-pessoal">D√∫vidas cr√©dito pessoal</option>
                                                    <option value="alteracao-cadastral">Altera√ß√£o cadastral</option>
                                                    <option value="duvidas-credito-trabalhador">D√∫vidas cr√©dito ao trabalhador</option>
                                                    <option value="divida-prescrita">D√≠vida Prescrita</option>
                                                    <option value="duvidas-restituicao">D√∫vidas Restitui√ß√£o</option>
                                                </select>
                                            </div>
                                            <div class="mb-3">
                                                <label for="id-reclamacao" class="form-label">ID da Reclama√ß√£o: <span class="text-danger">*</span></label>
                                                <input type="text" class="form-control" id="id-reclamacao" placeholder="Digite o ID da reclama√ß√£o" required style="max-width: 200px;">
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="solucao-implementada" class="form-label">Solu√ß√£o Implementada: <span class="text-danger">*</span></label>
                                                <textarea class="form-control" id="solucao-implementada" rows="3" placeholder="Descreva as a√ß√µes j√° realizadas..." required></textarea>
                                            </div>
                                            <div class="mb-3">
                                                <label for="historico-atendimento" class="form-label">Hist√≥rico de Atendimento:</label>
                                                <textarea class="form-control" id="historico-atendimento" rows="2" placeholder="Registre contatos pr√©vios (WhatsApp, e-mail, telefone)..."></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label for="reclamacao-text" class="form-label">Reclama√ß√£o do Cliente: <span class="text-danger">*</span></label>
                                        <textarea class="form-control" id="reclamacao-text" rows="4" placeholder="Cole aqui o relato completo do cliente..." required></textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label for="observacoes-internas" class="form-label">Observa√ß√µes Internas:</label>
                                        <textarea class="form-control" id="observacoes-internas" rows="2" placeholder="Anota√ß√µes da equipe (n√£o vis√≠vel ao cliente)..."></textarea>
                                    </div>
                                    
                                    <div class="d-flex gap-2 mb-3">
                                        <button class="btn btn-success" onclick="gerarRespostaOpenAI()">
                                            <i class="fas fa-robot me-2"></i>
                                            Gerar Resposta com IA OpenAI
                                        </button>
                                        <button class="btn btn-outline-primary" onclick="salvarRascunho()">
                                            <i class="fas fa-save me-2"></i>
                                            Salvar Rascunho
                                        </button>
                                        <button class="btn btn-outline-secondary" onclick="carregarRascunho()">
                                            <i class="fas fa-folder-open me-2"></i>
                                            Carregar Rascunho
                                        </button>
                                        <button class="btn btn-warning" onclick="testarFuncao()">
                                            <i class="fas fa-bug me-2"></i>
                                            Testar Fun√ß√£o
                                    </button>
                                    </div>
                                    
                                    <!-- √Årea de Resposta IA OpenAI -->
                                    <div id="resposta-gpt5" class="mt-4" style="display: none;">
                                        <div class="card border-success">
                                            <div class="card-header bg-success text-white">
                                                <h6 class="mb-0">
                                                    <i class="fas fa-robot me-2"></i>
                                                    Resposta Gerada pela IA OpenAI
                                                </h6>
                                            </div>
                                            <div class="card-body">
                                                <div class="mb-3">
                                                    <label for="texto-resposta-gpt5" class="form-label">Texto da Resposta:</label>
                                                    <textarea class="form-control" id="texto-resposta-gpt5" rows="8" placeholder="Resposta ser√° gerada aqui..."></textarea>
                                                </div>
                                                
                                                <!-- Campo de Feedback para Reformula√ß√£o -->
                                                <div id="campo-feedback" class="mb-3" style="display: none;">
                                                    <label for="feedback-reformulacao" class="form-label">
                                                        <i class="fas fa-comment-dots me-2"></i>
                                                        Feedback para Reformula√ß√£o:
                                                    </label>
                                                    <textarea class="form-control" id="feedback-reformulacao" rows="3" 
                                                        placeholder="Descreva o que deve ser alterado na resposta: an√°lise do caso, tom, informa√ß√µes espec√≠ficas, etc."></textarea>
                                                    <div class="form-text">
                                                        <small>Exemplo: "Foque mais na solu√ß√£o implementada", "Adicione informa√ß√µes sobre o prazo", "Mude o tom para mais emp√°tico"</small>
                                                    </div>
                                                </div>
                                                
                                                <!-- Bot√µes de Avalia√ß√£o -->
                                                <div class="d-flex gap-2 mb-3">
                                                    <button class="btn btn-success" onclick="avaliarResposta('coerente')">
                                                        <i class="fas fa-check-circle me-2"></i>
                                                        Resposta Coerente
                                                    </button>
                                                    <button class="btn btn-warning" onclick="avaliarResposta('reformular')">
                                                        <i class="fas fa-redo me-2"></i>
                                                        Incoerente / Reformular
                                                    </button>
                                                </div>
                                                
                                                <!-- Bot√µes de Confirma√ß√£o de Reformula√ß√£o -->
                                                <div id="botoes-reformulacao" class="d-flex gap-2 mb-3" style="display: none;">
                                                    <button class="btn btn-outline-secondary" onclick="cancelarReformulacao()">
                                                        <i class="fas fa-times me-2"></i>
                                                        Cancelar
                                                    </button>
                                                </div>
                                                
                                                <!-- Bot√µes de A√ß√£o -->
                                                <div class="d-flex gap-2">
                                                    <button class="btn btn-primary" onclick="copiarRespostaOpenAI()">
                                                        <i class="fas fa-copy me-2"></i>
                                                        Copiar Resposta
                                                    </button>
                                                    <button class="btn btn-outline-secondary" onclick="limparRespostaOpenAI()">
                                                        <i class="fas fa-times me-2"></i>
                                                        Limpar
                                                    </button>
                                                    <button class="btn btn-outline-info" onclick="verHistorico()">
                                                        <i class="fas fa-history me-2"></i>
                                                        Ver Hist√≥rico
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- √Årea de Hist√≥rico -->
                                    <div id="historico-respostas" class="mt-4" style="display: none;">
                                        <div class="card border-info">
                                            <div class="card-header bg-info text-white">
                                                <h6 class="mb-0">
                                                    <i class="fas fa-history me-2"></i>
                                                    Hist√≥rico de Respostas
                                                </h6>
                                            </div>
                                            <div class="card-body">
                                                <div id="lista-historico"></div>
                                                <button class="btn btn-outline-secondary btn-sm mt-2" onclick="fecharHistorico()">
                                                    <i class="fas fa-times me-1"></i>
                                                    Fechar
                                            </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Modera√ß√£o RA Tool -->
                        <div id="moderacao-tool" class="tool-panel">
                            <div class="card">
                                <div class="card-header bg-success text-white">
                                    <h5 class="mb-0">
                                        <i class="fas fa-shield-alt me-2"></i>
                                        Solicita√ß√£o de Modera√ß√£o - Reclame Aqui
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label for="id-reclamacao-moderacao" class="form-label">ID da Reclama√ß√£o (Reclame Aqui): <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control" id="id-reclamacao-moderacao" placeholder="Digite o ID num√©rico da reclama√ß√£o" required pattern="[0-9]+" title="Apenas n√∫meros s√£o permitidos" style="max-width: 300px;">
                                        <small class="form-text text-muted">ID utilizado na plataforma do Reclame Aqui (apenas n√∫meros)</small>
                                    </div>
                                    <div class="mb-3">
                                        <label for="solicitacao-cliente" class="form-label">Solicita√ß√£o do Cliente:</label>
                                        <textarea class="form-control" id="solicitacao-cliente" rows="4" placeholder="Descreva a solicita√ß√£o do cliente de forma escrita..."></textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label for="resposta-empresa" class="form-label">Resposta da Empresa:</label>
                                        <textarea class="form-control" id="resposta-empresa" rows="4" placeholder="Descreva a resposta da empresa de forma escrita..."></textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label for="motivo-moderacao" class="form-label">Motivo da Modera√ß√£o:</label>
                                        <select class="form-select" id="motivo-moderacao">
                                            <option value="">Selecione o motivo da modera√ß√£o...</option>
                                            <option value="reclamacao-outra-empresa">Reclama√ß√£o de outra empresa</option>
                                            <option value="reclamacao-trabalhista">Reclama√ß√£o trabalhista</option>
                                            <option value="conteudo-improprio">Conte√∫do impr√≥prio</option>
                                            <option value="reclamacao-duplicidade">Reclama√ß√£o em duplicidade</option>
                                            <option value="reclamacao-terceiros">Reclama√ß√£o de terceiros</option>
                                            <option value="caso-fraude">Este √© um caso de fraude</option>
                                            <option value="nao-violou-direito">A empresa n√£o violou o direito do consumidor</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label for="consideracao-final" class="form-label">Considera√ß√£o Final do Consumidor:</label>
                                        <textarea class="form-control" id="consideracao-final" rows="4" placeholder="Descreva a considera√ß√£o final do consumidor de forma escrita..."></textarea>
                                    </div>
                                    <div class="d-flex gap-2 mb-3">
                                        <button class="btn btn-success" onclick="gerarModeracao()">
                                            <i class="fas fa-shield-alt me-2"></i>
                                            Gerar Solicita√ß√£o de Modera√ß√£o
                                        </button>
                                        <button class="btn btn-info" onclick="gerarFeedbackModeracao()">
                                            <i class="fas fa-comment-dots me-2"></i>
                                            Analisar Feedback
                                        </button>
                                    </div>
                                    <div id="moderacao-resultado" class="mt-4" style="display: none;">
                                        <h6>Solicita√ß√£o de Modera√ß√£o:</h6>
                                        <div class="response-box">
                                            <div id="linha-raciocinio"></div>
                                            <hr>
                                            <div id="texto-moderacao"></div>
                                            <div class="mt-3">
                                                <button class="btn btn-outline-warning btn-sm me-2" onclick="copiarModeracao()">
                                                <i class="fas fa-copy me-1"></i>
                                                Copiar Solicita√ß√£o
                                            </button>
                                                <button class="btn btn-success btn-sm me-2" onclick="avaliarModeracao('coerente')">
                                                    <i class="fas fa-check me-1"></i>
                                                    Solicita√ß√£o Coerente
                                                </button>
                                                <button class="btn btn-warning btn-sm me-2" onclick="avaliarModeracao('incoerente')">
                                                    <i class="fas fa-redo me-1"></i>
                                                    Incoerente / Reformular
                                                </button>
                                                <button class="btn btn-danger btn-sm" onclick="reformularAposNegativa()">
                                                    <i class="fas fa-exclamation-triangle me-1"></i>
                                                    Reformular ap√≥s Negativa
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div id="feedback-moderacao" class="mt-4" style="display: none;">
                                        <h6>An√°lise de Feedback:</h6>
                                        <div class="response-box">
                                            <div id="feedback-conteudo"></div>
                                        </div>
                                        <button class="btn btn-secondary mt-3" onclick="copiarFeedback()">
                                            <i class="fas fa-copy me-2"></i>
                                            Copiar Feedback
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Explica√ß√µes Tool -->
                        <div id="explicacoes-tool" class="tool-panel">
                            <div class="card">
                                <div class="card-header bg-info text-white">
                                    <h5 class="mb-0">
                                        <i class="fas fa-question-circle me-2"></i>
                                        Mensagens Explicativas
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label for="tema-explicacao" class="form-label">Tema a Explicar:</label>
                                        <select class="form-select" id="tema-explicacao">
                                            <option value="">Selecione o tema...</option>
                                            <option value="malha-fina">Malha Fina e Regulariza√ß√£o</option>
                                            <option value="exclusao">Exclus√£o de Cadastro</option>
                                            <option value="procuracoes">Revoga√ß√£o de Procura√ß√µes</option>
                                            <option value="ccb">C√©dula de Cr√©dito Banc√°rio</option>
                                            <option value="credito-trabalhador">Cr√©dito do Trabalhador</option>
                                            <option value="credito-pessoal">Cr√©dito Pessoal</option>
                                            <option value="seguro-divida-zero">Seguro D√≠vida Zero</option>
                                            <option value="seguro-saude-simplificada">Seguro Sa√∫de Simplificada</option>
                                            <option value="clube-velotax">Clube Velotax</option>
                                        </select>
                                    </div>
                                    <button class="btn btn-info" onclick="gerarExplicacao()">
                                        <i class="fas fa-lightbulb me-2"></i>
                                        Gerar Explica√ß√£o
                                    </button>
                                    <div id="explicacao-resultado" class="mt-4" style="display: none;">
                                        <h6>Mensagem Explicativa:</h6>
                                        <div class="response-box">
                                            <div id="explicacao-content"></div>
                                            <button class="btn btn-outline-info btn-sm mt-2" onclick="copiarResposta('explicacao-content')">
                                                <i class="fas fa-copy me-1"></i>
                                                Copiar Mensagem
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Chance de Modera√ß√£o Tool -->
                        <div id="revisao-tool" class="tool-panel">
                            <div class="card">
                                <div class="card-header bg-secondary text-white">
                                    <h5 class="mb-0">
                                        <i class="fas fa-percentage me-2"></i>
                                        An√°lise de Chance de Modera√ß√£o
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label for="reclamacao-completa" class="form-label">Reclama√ß√£o Completa do Consumidor: <span class="text-danger">*</span></label>
                                        <textarea class="form-control" id="reclamacao-completa" rows="6" placeholder="Cole aqui a reclama√ß√£o completa do consumidor..." required></textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label for="resposta-publica" class="form-label">Resposta P√∫blica da Empresa: <span class="text-danger">*</span></label>
                                        <textarea class="form-control" id="resposta-publica" rows="6" placeholder="Cole aqui a resposta p√∫blica da empresa..." required></textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label for="consideracao-final" class="form-label">Considera√ß√£o Final (se houver):</label>
                                        <textarea class="form-control" id="consideracao-final" rows="4" placeholder="Cole aqui a considera√ß√£o final do consumidor, se houver..."></textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label for="historico-moderacao" class="form-label">Hist√≥rico de Tentativas de Modera√ß√£o (se houver):</label>
                                        <textarea class="form-control" id="historico-moderacao" rows="3" placeholder="Descreva tentativas anteriores de modera√ß√£o, se houver..."></textarea>
                                    </div>
                                    <button class="btn btn-secondary" onclick="analisarChanceModeracao()">
                                        <i class="fas fa-percentage me-2"></i>
                                        Analisar Chance de Modera√ß√£o
                                    </button>
                                    <div id="revisao-resultado" class="mt-4" style="display: none;">
                                        <div class="response-box">
                                            <div id="analise-chance-moderacao"></div>
                                            <div class="mt-3">
                                                <button class="btn btn-outline-secondary btn-sm me-2" onclick="copiarResposta('analise-chance-moderacao')">
                                                    <i class="fas fa-copy me-1"></i>
                                                    Copiar An√°lise Completa
                                                </button>
                                                <button class="btn btn-outline-primary btn-sm me-2" onclick="copiarRespostaRevisada()">
                                                    <i class="fas fa-copy me-1"></i>
                                                    Copiar Apenas Resposta Revisada
                                                </button>
                                                <button class="btn btn-outline-warning btn-sm" onclick="abrirModalAjusteManual()" id="btn-ajuste-manual" style="display: none;">
                                                    <i class="fas fa-edit me-1"></i>
                                                    Ajustar trecho espec√≠fico da resposta
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Formula√ß√£o de E-mail Tool -->
                        <div id="emails-tool" class="tool-panel">
                            <div class="card">
                                <div class="card-header bg-dark text-white">
                                    <h5 class="mb-0">
                                        <i class="fas fa-envelope me-2"></i>
                                        Formula√ß√£o de E-mail
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="tipo-email" class="form-label">Tipo de E-mail:</label>
                                                <select class="form-select" id="tipo-email" required>
                                                    <option value="">Selecione o tipo...</option>
                                                    <option value="resposta-cliente">Resposta a Cliente</option>
                                                    <option value="solicitacao-moderacao">Solicita√ß√£o de Modera√ß√£o</option>
                                                    <option value="juridico">Jur√≠dico</option>
                                                </select>
                                            </div>
                                            <div class="mb-3">
                                                <label for="destinatario" class="form-label">Destinat√°rio:</label>
                                                <input type="text" class="form-control" id="destinatario" placeholder="Nome ou identifica√ß√£o do destinat√°rio...">
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="contexto-email" class="form-label">Contexto:</label>
                                                <textarea class="form-control" id="contexto-email" rows="5" placeholder="Descreva o contexto da situa√ß√£o, incluindo fatos, hist√≥rico, explica√ß√µes, datas, IDs, justificativas e demais informa√ß√µes relevantes..."></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="btn btn-dark" onclick="gerarEmail()">
                                        <i class="fas fa-envelope me-2"></i>
                                        Gerar E-mail
                                    </button>
                                    <div id="email-resultado" class="mt-4" style="display: none;">
                                        <h6>E-mail Gerado:</h6>
                                        <div class="response-box">
                                            <div id="email-content"></div>
                                            <button class="btn btn-outline-dark btn-sm mt-2" onclick="copiarResposta('email-content')">
                                                <i class="fas fa-copy me-1"></i>
                                                Copiar E-mail
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <!-- FAQ Tool -->
                        <div id="faq-tool" class="tool-panel">
                            <div class="card">
                                <div class="card-header" style="background: linear-gradient(135deg, #1DFDB9 0%, #1634FF 100%); color: white;">
                                    <h5 class="mb-0">
                                        <i class="fas fa-question me-2"></i>
                                        FAQ
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <!-- Abas para FAQ e Gerenciamento -->
                                    <ul class="nav nav-tabs mb-3" id="faqTabs" role="tablist">
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link active" id="gerar-faq-tab" data-bs-toggle="tab" data-bs-target="#gerar-faq" type="button" role="tab">
                                                <i class="fas fa-magic me-1"></i> Gerar FAQ
                                            </button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" id="gerenciar-faq-tab" data-bs-toggle="tab" data-bs-target="#gerenciar-faq" type="button" role="tab">
                                                <i class="fas fa-cog me-1"></i> Gerenciar FAQs
                                            </button>
                                        </li>
                                    </ul>
                                    
                                    <div class="tab-content" id="faqTabContent">
                                        <!-- Tab: Gerar FAQ -->
                                        <div class="tab-pane fade show active" id="gerar-faq" role="tabpanel">
                                            <div class="mb-3">
                                                <label for="tema-faq" class="form-label">Tema:</label>
                                                <select class="form-select" id="tema-faq">
                                                    <option value="">Carregando temas...</option>
                                                </select>
                                            </div>
                                            <button class="btn btn-warning" onclick="gerarFAQ()">
                                                <i class="fas fa-question me-2"></i>
                                                Gerar Resposta FAQ
                                            </button>
                                            <div id="faq-resultado" class="mt-4" style="display: none;">
                                                <h6>Resposta FAQ:</h6>
                                                <div class="response-box">
                                                    <div id="faq-content"></div>
                                                    <button class="btn btn-outline-warning btn-sm mt-2" onclick="copiarResposta('faq-content')">
                                                        <i class="fas fa-copy me-1"></i>
                                                        Copiar Resposta
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Tab: Gerenciar FAQs -->
                                        <div class="tab-pane fade" id="gerenciar-faq" role="tabpanel">
                                            <div class="d-flex justify-content-between align-items-center mb-3">
                                                <h6 class="mb-0">Gerenciar FAQs</h6>
                                                <button class="btn btn-success btn-sm" onclick="abrirModalFAQ()">
                                                    <i class="fas fa-plus me-1"></i> Novo FAQ
                                                </button>
                                            </div>
                                            <div id="faqs-list" class="list-group">
                                                <div class="text-center p-3">
                                                    <div class="spinner-border text-primary" role="status">
                                                        <span class="visually-hidden">Carregando...</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Modal para Criar/Editar FAQ -->
                        <div class="modal fade" id="modalFAQ" tabindex="-1" aria-labelledby="modalFAQLabel" aria-hidden="true">
                            <div class="modal-dialog modal-lg">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="modalFAQLabel">Novo FAQ</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <form id="formFAQ">
                                            <input type="hidden" id="faq-id" value="">
                                            <div class="mb-3">
                                                <label for="faq-titulo" class="form-label">T√≠tulo (Pergunta):</label>
                                                <input type="text" class="form-control" id="faq-titulo" required placeholder="Ex: Quais s√£o os servi√ßos oferecidos pelo Velotax?">
                                            </div>
                                            <div class="mb-3">
                                                <label for="faq-tema" class="form-label">Tema (C√≥digo/Slug):</label>
                                                <input type="text" class="form-control" id="faq-tema" required placeholder="Ex: servicos-velotax" pattern="[a-z0-9-]+" title="Apenas letras min√∫sculas, n√∫meros e h√≠fens">
                                                <small class="form-text text-muted">Use apenas letras min√∫sculas, n√∫meros e h√≠fens (sem espa√ßos)</small>
                                            </div>
                                            <div class="mb-3">
                                                <label for="faq-explicacao" class="form-label">Explica√ß√£o (Resposta HTML):</label>
                                                <textarea class="form-control" id="faq-explicacao" rows="15" required placeholder="Digite a resposta em HTML..."></textarea>
                                                <small class="form-text text-muted">Voc√™ pode usar tags HTML como &lt;p&gt;, &lt;strong&gt;, &lt;ul&gt;, etc.</small>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                                        <button type="button" class="btn btn-primary" onclick="salvarFAQ()">
                                            <i class="fas fa-save me-1"></i> Salvar FAQ
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <!-- Modera√ß√£o de Notas Tool -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
        <!-- Script imediato removido - controle agora √© feito pelo auth.js -->
    
    <!-- Script para garantir que o overlay seja exibido imediatamente -->
    <script>
        // Script removido - controle de overlay agora √© feito pelo auth.js
    </script>
    
        <script src="auth.js?v=20250117dd"></script>
    <script src="script.js?v=6"></script>
    
    <!-- Sistema de ajuste autom√°tico do nome da interface -->
    <script>
        // Fun√ß√£o para ajustar automaticamente o nome da interface
        function adjustInterfaceName() {
            const interfaceName = document.querySelector('.interface-name');
            if (!interfaceName) return;
            
            const screenWidth = window.innerWidth;
            const screenHeight = window.innerHeight;
            
            // Calcular tamanho baseado na tela
            let fontSize, padding, maxWidth, top, right;
            
            if (screenWidth >= 1400) {
                // Telas muito grandes
                fontSize = '1.1rem';
                padding = '8px 16px';
                maxWidth = '180px';
                top = '20px';
                right = '30px';
            } else if (screenWidth >= 1200) {
                // Desktop padr√£o
                fontSize = '1rem';
                padding = '7px 14px';
                maxWidth = '160px';
                top = '18px';
                right = '25px';
            } else if (screenWidth >= 992) {
                // Laptop/Tablet grande
                fontSize = '0.9rem';
                padding = '6px 12px';
                maxWidth = '140px';
                top = '15px';
                right = '20px';
            } else if (screenWidth >= 768) {
                // Tablet
                fontSize = '0.8rem';
                padding = '5px 10px';
                maxWidth = '120px';
                top = '12px';
                right = '15px';
            } else if (screenWidth >= 576) {
                // Mobile grande
                fontSize = '0.75rem';
                padding = '4px 8px';
                maxWidth = '100px';
                top = '10px';
                right = '10px';
            } else {
                // Mobile pequeno
                fontSize = '0.7rem';
                padding = '3px 6px';
                maxWidth = '80px';
                top = '8px';
                right = '8px';
            }
            
            // Aplicar estilos
            interfaceName.style.fontSize = fontSize;
            interfaceName.style.padding = padding;
            interfaceName.style.maxWidth = maxWidth;
            interfaceName.style.top = top;
            interfaceName.style.right = right;
            
            // Log para debug (remover em produ√ß√£o)
            console.log(`üñ•Ô∏è Tela: ${screenWidth}x${screenHeight}px - Interface ajustada: ${fontSize}`);
        }
        
        // Executar na carga da p√°gina
        document.addEventListener('DOMContentLoaded', adjustInterfaceName);
        
        // Executar no redimensionamento da janela
        window.addEventListener('resize', adjustInterfaceName);
        
        // Executar ap√≥s um pequeno delay para garantir que tudo carregou
        setTimeout(adjustInterfaceName, 100);
    </script>
    </div> <!-- Fechamento do app-wrapper -->

    <!-- Modal de Solicita√ß√µes -->
    <div class="modal fade" id="modalSolicitacoes" tabindex="-1" aria-labelledby="modalSolicitacoesLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-info text-white">
                    <h5 class="modal-title" id="modalSolicitacoesLabel">
                        <i class="fas fa-list me-2"></i>
                        Todas as Solicita√ß√µes
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Filtros -->
                    <div class="row mb-3">
                        <div class="col-md-3">
                            <label for="filtroDataInicio" class="form-label">Data In√≠cio:</label>
                            <input type="date" class="form-control" id="filtroDataInicio">
                        </div>
                        <div class="col-md-3">
                            <label for="filtroDataFim" class="form-label">Data Fim:</label>
                            <input type="date" class="form-control" id="filtroDataFim">
                        </div>
                        <div class="col-md-3">
                            <label for="filtroTipo" class="form-label">Tipo:</label>
                            <select class="form-select" id="filtroTipo">
                                <option value="todas">Todas</option>
                                <option value="respostas">Respostas</option>
                                <option value="moderacoes">Modera√ß√µes</option>
                            </select>
                        </div>
                        <div class="col-md-3 d-flex align-items-end">
                            <button class="btn btn-primary w-100" onclick="buscarSolicitacoes()">
                                <i class="fas fa-search me-2"></i>
                                Buscar
                            </button>
                        </div>
                    </div>

                    <!-- Informa√ß√µes -->
                    <div class="alert alert-info" id="infoSolicitacoes" style="display: none;">
                        <i class="fas fa-info-circle me-2"></i>
                        <span id="textoInfoSolicitacoes"></span>
                    </div>

                    <!-- Tabela de Solicita√ß√µes -->
                    <div class="table-responsive" style="max-height: 500px; overflow-y: auto;">
                        <table class="table table-striped table-hover">
                            <thead class="table-dark sticky-top">
                                <tr>
                                    <th style="width: 50px;"></th>
                                    <th>Data/Hora</th>
                                    <th>Tipo</th>
                                    <th>ID</th>
                                    <th>Detalhes</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="tabelaSolicitacoes">
                                <tr>
                                    <td colspan="6" class="text-center text-muted">
                                        <i class="fas fa-spinner fa-spin me-2"></i>
                                        Carregando solicita√ß√µes...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                    <button type="button" class="btn btn-primary" onclick="exportarSolicitacoes()">
                        <i class="fas fa-download me-2"></i>
                        Exportar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Ajuste Manual -->
    <!-- Modal de An√°lise de Modera√ß√£o Negada (FASE 4) -->
    <div class="modal fade" id="modalAnaliseNegada" tabindex="-1" aria-labelledby="modalAnaliseNegadaLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title" id="modalAnaliseNegadaLabel">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        An√°lise Completa - Modera√ß√£o Negada (FASE 2)
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="modalAnaliseNegadaBody">
                    <div class="text-center py-5">
                        <div class="spinner-border text-danger" role="status">
                            <span class="visually-hidden">Carregando...</span>
                        </div>
                        <p class="mt-3">Carregando an√°lise completa...</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalAjusteManual" tabindex="-1" aria-labelledby="modalAjusteManualLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-warning text-dark">
                    <h5 class="modal-title" id="modalAjusteManualLabel">
                        <i class="fas fa-edit me-2"></i>
                        Ajustar Trecho Espec√≠fico da Resposta
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Instru√ß√£o:</strong> Descreva qual trecho deseja ajustar e como deve ser alterado.
                        <br><small>Exemplo: "Alterar o trecho que menciona 'empr√©stimo negado por d√≠vidas' para 'cr√©dito n√£o aprovado por contrato ativo'."</small>
                    </div>
                    <div class="mb-3">
                        <label for="instrucao-ajuste-manual" class="form-label">Instru√ß√£o de Ajuste:</label>
                        <textarea class="form-control" id="instrucao-ajuste-manual" rows="4" placeholder="Descreva o trecho a ser ajustado e como deve ser alterado..."></textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Resposta Atual (para refer√™ncia):</label>
                        <div class="alert alert-light border" id="resposta-atual-ajuste" style="max-height: 200px; overflow-y: auto; font-size: 0.9rem;">
                            <!-- Ser√° preenchido via JavaScript -->
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-warning" onclick="executarAjusteManual()">
                        <i class="fas fa-check me-2"></i>
                        Aplicar Ajuste
                    </button>
                </div>
            </div>
        </div>
    </div>

</body>
</html> 